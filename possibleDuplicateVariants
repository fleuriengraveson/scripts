Sub HighlightSimilarText()
    Dim ws As Worksheet
    Dim cell1 As Range, cell2 As Range
    Dim arr1() As String, arr2() As String
    Dim dict As Object
    Dim word As Variant
    Dim i As Integer, count As Integer
    
    ' Set your worksheet - change "Sheet1" to your actual sheet name
    Set ws = ThisWorkbook.Sheets("Sheet1")
    
    ' Loop through each cell in the range to compare with every other cell
    For Each cell1 In ws.Range("A:A") ' Adjust the range as needed
        If cell1.Value <> "" Then
            ' Split the words in the first cell
            arr1 = Split(cell1.Value, " ")
            
            ' Loop through each cell again to compare with cell1
            For Each cell2 In ws.Range("A:A")
                If cell2.Address <> cell1.Address And cell2.Value <> "" Then
                    ' Split the words in the second cell
                    arr2 = Split(cell2.Value, " ")
                    
                    ' Use dictionary to count common words
                    Set dict = CreateObject("Scripting.Dictionary")
                    count = 0
                    
                    ' Store words from the first cell in the dictionary
                    For i = LBound(arr1) To UBound(arr1)
                        dict(Trim(arr1(i))) = True
                    Next i
                    
                    ' Check for common words in the second cell
                    For i = LBound(arr2) To UBound(arr2)
                        word = Trim(arr2(i))
                        If dict.exists(word) Then count = count + 1
                    Next i
                    
                    ' If at least 2 words are common, highlight both cells
                    If count >= 3 Then
                        cell1.Interior.Color = vbYellow
                        cell2.Interior.Color = vbYellow
                    End If
                End If
            Next cell2
        End If
    Next cell1
    
    MsgBox "Cells with at least two common words have been highlighted."
End Sub

